\documentclass[a4paper,11pt]{article}
\usepackage[utf8]{inputenc}
\begin{document}
\noindent
\begin{center}
\Large\textbf{RITS System Architecture}
\end{center}

\vspace{1cm}
\noindent
To use RITS, add the following line to your Prolog code:

\bigskip
\textbf{:- use\_module(rits).}
\bigskip

\noindent RITS is accessible via the following API calls:

\begin{itemize}
\item \textbf{rits\_start(-Start)}\\\textbf{Start} is unified with a
  Prolog term that represents the initial state of RITS, before the
  system has received any user actions.

\item \textbf{rits\_next\_action(+A0, -A, +S0, -S)}\\
  This predicate relates a user action \textbf{A0} and a RITS state
  \textbf{S0} to the RITS action \textbf{A} and next state~\textbf{S}.

\item \textbf{rits\_history(+S, -Hist)}\\
  \textbf{Hist} is unified with a list of Prolog terms that represent
  the history of user interactions up to state~\textbf{S}.
\end{itemize}

These predicates are completely \textit{pure}: They no not emit any
output, do not write any files, and do not query the user in any way.
Therefore, they can be quite safely executed in a hosting environment.

User actions are described in Table~\ref{tab:useractions}. RITS
actions are described in Table~\ref{tab:ritsactions}. RITS clients are
expected to interpret RITS actions ``appropriately'', such as:
displaying messages on the terminal or via HTML, allowing users to
give answers etc.

\begin{table}[ht]
  \centering
  \begin{tabular}{cp{7cm}}
    \hline
    \textbf{solve(Expr)} & Tell RITS that the task for the student is to simplify  the expression \textbf{Expr}.\\
    \textbf{student\_answers(T)} & Tell RITS that the student has responded with \textbf{T}. This action is only admissible if the directly preceding RITS action was \textbf{read\_answer}.\\
    \textbf{next} & Query RITS for its next action. \\
    \textbf{skip} & The student wants to skip solving the subproblem that is
    currently in progress. (\textit{TODO})\\
    \hline
  \end{tabular}
\caption{Admissible user actions}
  \label{tab:useractions}
\end{table}

\begin{table}[ht]
  \centering
  \begin{tabular}{cp{7cm}}
    \hline
    \textbf{enter} & Start of a subproblem that the student must solve.\\
    \textbf{exit} & The most recently spawned subproblem was solved.\\
    \textbf{format(F)} & The string \textbf{F} is to be displayed.\\
    \textbf{format(F,As)} & The format string \textbf{F} is to be displayed. \textbf{As} is a list of arguments that are output, in sequence, in place of each \texttt{\~ w} that appears in \textbf{F}.\\
    \textbf{read\_answer} & The student is to be queried for a an answer.\\
    \textbf{fraction\_layout(T)} & The term \textbf{T} is to be displayed. (\textit{to be refined})\\
    \textbf{solve(Expr)} & The student should be given the task to simplify \textbf{Expr}.\\
    \textbf{done} & There are no further actions.\\
    \hline
  \end{tabular}
\caption{Valid RITS actions}
  \label{tab:ritsactions}
\end{table}


\vspace{0.7cm}

Due to their purity, these predicates are also very amenable to
regression testing and further analysis. (\textit{more to follow})

\vspace{0.7cm}

The RITS engine may be accessed directly via Prolog, remotely via
JavaScript and \textit{pengines}, or via any other language embedding.

\bigskip
\begin{center}
  \large\textbf{Extending RITS}
\end{center}

\medskip
\noindent Internally, RITS uses the following predicates to decide
what to do. All of them are DCG rules that describe a list of RITS
actions that need to be performed in response to certain user actions.

\begin{itemize}
\item \textbf{rits:solve//1}: this is called with argument \textbf{Expr}
  for user actions of the form \textbf{solve(Expr)}.

\item \textbf{rits:actions//3}: This is called with arguments \textbf{Expr}
  and \textbf{Answer} after the user answered the question posed after
  \textbf{solve(Expr)} with \textbf{Answer}. The third argument is a
  Prolog representation of previous interactions of the form
  \textbf{Expr=Answer}.

\end{itemize}

RITS can be extended in a \textit{modular} way to handle new domains.
To teach RITS additional rules, define a Prolog module that provides
its own (additional) DCG rules for \textbf{rits:solve//1} and
\textbf{rits:actions//3}. 

In these DCG rules, modules may provide their own custom RITS actions
as Prolog terms that must be handled by the client when they appear as
a RITS action upon calling \textbf{rits_next_action/4}.

See the file \textbf{rits\_multiple\_choice.pl} for the definition of
simple multiple choice tests that are repeated when wrong answers are
given.


\vfil
\end{document}

